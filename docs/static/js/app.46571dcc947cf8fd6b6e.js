webpackJsonp([1],{NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("7+uW"),s=i("L+qL"),r=i("Gu7T"),a=i.n(r),o=i("lHA8"),c=i.n(o),h=i("fZjL"),l=i.n(h),u=i("wxAW"),d=i.n(u),p=i("kiBT"),m=i.n(p),f=i("Zx67"),g=i.n(f),v=i("Zrlr"),y=i.n(v),S=i("zwoO"),w=i.n(S),_=i("Pf15"),x=i.n(_),O=i("gApy"),P=(function(e){function t(e){y()(this,t);var i=w()(this,(t.__proto__||g()(t)).call(this,e));return i.name="PointError",m()(i,t.prototype),i}x()(t,e)}(Error),function(e){function t(e){y()(this,t);var i=w()(this,(t.__proto__||g()(t)).call(this,e));return i.name="TimeSeriesError",m()(i,t.prototype),i}return x()(t,e),t}(Error)),T=function(e){function t(e){y()(this,t);var i=w()(this,(t.__proto__||g()(t)).call(this,e));return i.name="TimeSeriesPointNotExist",m()(i,t.prototype),i}return x()(t,e),t}(P),b=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{points:[]},n=i.name,s=void 0===n?"":n,r=i.points,a=void 0===r?[]:r;y()(this,e),this.id="timeserie-"+O(),this.name=s,this.timestampToPoint={},this.points=[],a.forEach(function(e){t.add(e)})}return d()(e,[{key:"getEchartSerie",value:function(){return{type:"line",data:this.points.map(function(e){return e.value})}}},{key:"getEchartAxis",value:function(){return{name:this.name}}},{key:"getPoint",value:function(e){if(!this.hasTimestamp(e))throw new P("the given timestamp does not exist");return this.timestampToPoint[e]}},{key:"hasTimestamp",value:function(e){return this.timestampToPoint.hasOwnProperty(e)}},{key:"getTimestamps",value:function(){return l()(this.timestampToPoint).map(function(e){return parseInt(e)})}},{key:"add",value:function(e){this.timestampToPoint[e.timestamp]=e,this.points.push(e)}},{key:"remove",value:function(e){var t=this.points.indexOf(e);if(-1===t)throw new T("The given point does not exist in the serie");this.points.splice(t,1),delete this.timestampToPoint[e.timestamp]}},{key:"removePointWithTimestamp",value:function(e){if(!this.timestampToPoint.hasOwnProperty(e))throw new P("The given timestamp does not exist");var t=this.timestampToPoint[e];this.remove(t)}}],[{key:"buildFromDTO",value:function(t){var i=t.series.datetime.map(function(e,i){return new function e(t){y()(this,e),this.timestamp=t.timestamp,this.value=t.value}({timestamp:e,value:t.series.val[i]})});return new e({name:t.name,points:i})}}]),e}(),A=function(e){function t(e){return y()(this,t),w()(this,(t.__proto__||g()(t)).call(this,e))}return x()(t,e),t}(Error),k=function(e){function t(e){return y()(this,t),w()(this,(t.__proto__||g()(t)).call(this,e))}return x()(t,e),t}(A),L=function(){function e(){y()(this,e),this.timeSeriesList=[],this.timeSeriesMap={}}return d()(e,[{key:"add",value:function(e){this.timeSeriesList.push(e),this.timeSeriesMap[e.id]=e}},{key:"remove",value:function(e){var t=this.timeSeriesList.indexOf(e);if(t<0)throw new A("the given timeserie does not exist");this.timeSeriesList.splice(t,1),delete this.timeSeriesMap[e.id]}},{key:"isEmpty",value:function(){return 0===this.timeSeriesList.length}},{key:"getOverlappedTimestamp",value:function(){var e=this;if(this.isEmpty())throw new k;for(var t=this.timeSeriesList[0].getTimestamps(),i=new c.a(t),n=function(t){var n=new c.a;e.timeSeriesList[t].getTimestamps().forEach(function(e){i.has(e)&&n.add(e)}),i=n},s=1;s<this.timeSeriesList.length;s++)n(s);return[].concat(a()(i))}},{key:"getScatterPoints",value:function(){var e=this;console.log("getScatterPoints");var t=void 0;try{t=this.getOverlappedTimestamp()}catch(e){console.log("Failed to get overlapped timestamp"),console.error("Reason : ",e),t=[]}return t.map(function(t){var i=[];return e.timeSeriesList.forEach(function(e){var n=e.getPoint(t);i.push(n.value)}),i.push(t),i})}},{key:"removePoint",value:function(e){try{this.timeSeriesList.forEach(function(t){t.remove(e)})}catch(t){t instanceof T||(console.error("Failed to remove the given point ",e),console.error("Reason : ",t))}}},{key:"removePointWithTimestamp",value:function(e){this.timeSeriesList.forEach(function(t){try{t.removePointWithTimestamp(e)}catch(t){console.error("Failed to remove point with timestamp ",e),console.error("Reason : ",t.message)}})}}]),e}(),E={name:"serie-to-serie-analysis",props:{baseSerie:{type:b,required:!0},driverSerie:{type:b,required:!0}},data:function(){var e=new L;return e.add(this.driverSerie),e.add(this.baseSerie),{timeserieManager:e,scatterPoints:[],chartOptions:{title:{text:"Series to Series"},xAxis:[{name:this.baseSerie.name,nameLocation:"middle"}],yAxis:[{name:this.driverSerie.name,nameLocation:"middle"}],series:[{symbolSize:20,data:[],type:"scatter"}]}}},computed:{x:function(){var e=[];return this.scatterPoints.forEach(function(t){e.push(t[0])}),e},y:function(){var e=[];return this.scatterPoints.forEach(function(t){e.push(t[1])}),e},regression:function(){return new s.a(this.x,this.y)},regressionPoints:function(){var e=this.regression,t=e.slope,i=e.intercept;e.coefficients;return this.x.map(function(e){return[e,t*e+i]})}},watch:{timeserieManager:{immediate:!0,deep:!0,handler:function(e){console.log("New timeserieManager : ",e),this.scatterPoints=e.getScatterPoints()}},scatterPoints:{immediate:!0,handler:function(e){console.log("New scattered points : ",e,"\n"),this.chartOptions.series[0].data=e}},regressionPoints:{immediate:!0,handler:function(e){console.log("New regression points :",e,"\n"),this.chartOptions.series.length>1?(this.chartOptions.series.splice(1,1),this.chartOptions.series.push({name:"line",type:"line",showSymbol:!1,smooth:!0,markPoint:{itemStyle:{normal:{color:"transparent"}},label:{normal:{show:!0,position:"left",textStyle:{color:"#333",fontSize:14}}}},data:this.regressionPoints})):this.chartOptions.series.push({name:"line",type:"line",showSymbol:!1,smooth:!0,markPoint:{itemStyle:{normal:{color:"transparent"}},label:{normal:{show:!0,position:"left",textStyle:{color:"#333",fontSize:14}}}},data:this.regressionPoints})}}},methods:{handleChartClick:function(e){console.log("Clicked event : ",e);var t=e.data[2];this.timeserieManager.removePointWithTimestamp(t)}}},M={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"serie-to-serie-analysis"},[t("chart",{ref:"chart",staticClass:"serie-to-serie-analysis__chart",attrs:{options:this.chartOptions,"auto-resize":!0},on:{click:this.handleChartClick}})],1)},staticRenderFns:[]},z=i("VU/8")(E,M,!1,null,null,null).exports,C=i("Dd8w"),D=i.n(C),R={name:"timestamp-to-serie-analysis",props:{baseSerie:{type:b,required:!0},driverSeries:{type:L,required:!1,default:new L}},data:function(){return{baseAxis:{name:this.baseSerie.name,data:this.baseSerie.getTimestamps(),nameLocation:"middle"}}},computed:{chartOptions:function(){var e={title:{text:"Series to Timestamp"},xAxis:[],yAxis:[],series:[],grid:{left:65,right:65}};return e.xAxis.push(this.baseAxis),this.driverSeries.timeSeriesList.forEach(function(t,i){e.yAxis.push(D()({},t.getEchartAxis(),{nameLocation:"middle",nameGap:42})),e.series.push(D()({},t.getEchartSerie(),{xAxisIndex:0,yAxisIndex:i}))}),e}}},F={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"timestamp-to-serie-analysis"},[t("chart",{ref:"chart",staticClass:"timestamp-to-serie-analysis__chart",attrs:{options:this.chartOptions,"auto-resize":!0}})],1)},staticRenderFns:[]},$={name:"data-analysis",components:{TimestampToSerieAnalysis:i("VU/8")(R,F,!1,null,null,null).exports,SerieToSerie:z},props:{initialBaseline:{type:Object,required:!0},initialDrivers:{type:Array,required:!1,default:function(){return[]}}},data:function(){var e=new L;return this.initialDrivers.forEach(function(t){e.add(b.buildFromDTO(t))}),{baseSerie:b.buildFromDTO(this.initialBaseline),driverSeries:e}}},j={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-analysis"},[i("div",{staticClass:"data-analysis__head"}),e._v(" "),i("div",{staticClass:"data-analysis__body"},[i("div",{staticClass:"timestamp-to-serie-wrapper"},[i("timestamp-to-serie-analysis",{attrs:{baseSerie:e.baseSerie,driverSeries:e.driverSeries}})],1),e._v(" "),i("div",{staticClass:"serie-to-serie-list"},e._l(e.driverSeries.timeSeriesList,function(t){return i("div",{key:t.id,staticClass:"serie-to-serie-item"},[i("serie-to-serie",{attrs:{baseSerie:e.baseSerie,driverSerie:t}})],1)}))])])},staticRenderFns:[]},U={name:"App",components:{DataAnalysis:i("VU/8")($,j,!1,null,null,null).exports},data:function(){return{happinessSerie:{name:"Happiness",series:{datetime:[20,30,40,50,60,70],val:[1,2,3,4,5,6]}},foodSerie:{name:"Food",series:{datetime:[20,30,40,50,60,70],val:[4862.4,5294.7,5934.5,7171,8964.4,20]}},travelSerie:{name:"Travel",series:{datetime:[20,30,40,50,60,70],val:[100,300,50,500,700,20]}}}}},H={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("data-analysis",{attrs:{initialBaseline:this.happinessSerie,initialDrivers:[this.foodSerie,this.travelSerie]}})],1)},staticRenderFns:[]},q=i("VU/8")(U,H,!1,null,null,null).exports,B=i("Icdr"),V=i.n(B),W=i("O4Lo"),G=i.n(W),N=i("472O"),I=["legendselectchanged","legendselected","legendunselected","datazoom","datarangeselected","timelinechanged","timelineplaychanged","restore","dataviewchanged","magictypechanged","geoselectchanged","geoselected","geounselected","pieselectchanged","pieselected","pieunselected","mapselectchanged","mapselected","mapunselected","axisareaselected","focusnodeadjacency","unfocusnodeadjacency","brush","brushselected","click","dblclick","mouseover","mouseout","mousedown","mouseup","globalout"],J={props:{options:Object,theme:[String,Object],initOptions:Object,group:String,autoResize:Boolean,watchShallow:Boolean},data:function(){return{chart:null,lastArea:0}},computed:{width:{cache:!1,get:function(){return this.delegateGet("width","getWidth")}},height:{cache:!1,get:function(){return this.delegateGet("height","getHeight")}},isDisposed:{cache:!1,get:function(){return!!this.delegateGet("isDisposed","isDisposed")}},computedOptions:{cache:!1,get:function(){return this.delegateGet("computedOptions","getOption")}}},watch:{group:function(e){this.chart.group=e}},methods:{mergeOptions:function(e,t,i){this.delegateMethod("setOption",e,t,i)},appendData:function(e){this.delegateMethod("appendData",e)},resize:function(e){this.delegateMethod("resize",e)},dispatchAction:function(e){this.delegateMethod("dispatchAction",e)},convertToPixel:function(e,t){return this.delegateMethod("convertToPixel",e,t)},convertFromPixel:function(e,t){return this.delegateMethod("convertFromPixel",e,t)},containPixel:function(e,t){return this.delegateMethod("containPixel",e,t)},showLoading:function(e,t){this.delegateMethod("showLoading",e,t)},hideLoading:function(){this.delegateMethod("hideLoading")},getDataURL:function(e){return this.delegateMethod("getDataURL",e)},getConnectedDataURL:function(e){return this.delegateMethod("getConnectedDataURL",e)},clear:function(){this.delegateMethod("clear")},dispose:function(){this.delegateMethod("dispose")},delegateMethod:function(e){var t;if(this.chart){for(var i=arguments.length,s=Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];return(t=this.chart)[e].apply(t,a()(s))}n.a.util.warn("Cannot call ["+e+"] before the chart is initialized. Set prop [options] first.",this)},delegateGet:function(e,t){return this.chart||n.a.util.warn("Cannot get ["+e+"] before the chart is initialized. Set prop [options] first.",this),this.chart[t]()},getArea:function(){return this.$el.offsetWidth*this.$el.offsetHeight},init:function(){var e=this;if(!this.chart){var t=V.a.init(this.$el,this.theme,this.initOptions);this.group&&(t.group=this.group),t.setOption(this.options,!0),I.forEach(function(i){t.on(i,function(t){e.$emit(i,t)})}),this.autoResize&&(this.lastArea=this.getArea(),this.__resizeHandler=G()(function(){0===e.lastArea?(e.mergeOptions({},!0),e.resize(),e.mergeOptions(e.options,!0)):e.resize(),e.lastArea=e.getArea()},100,{leading:!0}),Object(N.a)(this.$el,this.__resizeHandler)),this.chart=t}},destroy:function(){this.autoResize&&Object(N.b)(this.$el,this.__resizeHandler),this.dispose(),this.chart=null},refresh:function(){this.destroy(),this.init()}},created:function(){var e=this;this.$watch("options",function(t){!e.chart&&t?e.init():e.chart.setOption(e.options,!0)},{deep:!this.watchShallow});["theme","initOptions","autoResize","watchShallow"].forEach(function(t){e.$watch(t,function(){e.refresh()},{deep:!0})})},mounted:function(){this.options&&this.init()},activated:function(){this.autoResize&&this.chart&&this.chart.resize()},beforeDestroy:function(){this.chart&&this.destroy()},connect:function(e){"string"!=typeof e&&(e=e.map(function(e){return e.chart})),V.a.connect(e)},disconnect:function(e){V.a.disConnect(e)},registerMap:function(e,t,i){V.a.registerMap(e,t,i)},registerTheme:function(e,t){V.a.registerTheme(e,t)},graphic:V.a.graphic},Z={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"echarts"})},staticRenderFns:[]};var K=i("VU/8")(J,Z,!1,function(e){i("VMJk")},null,null).exports;i("4UDB"),i("u9yV"),i("k9Bd"),i("Oq2I");n.a.config.productionTip=!1,n.a.component("chart",K),new n.a({el:"#app",components:{App:q},template:"<App/>"})},VMJk:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.46571dcc947cf8fd6b6e.js.map